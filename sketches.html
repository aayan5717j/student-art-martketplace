<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Custom Sketches - Student Art Hub</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    .container{max-width:1000px;margin:0 auto;padding:16px}
    header nav a{margin-right:10px}
    .card{border:1px solid #ddd;border-radius:8px;padding:12px;margin:8px;width:240px}
    .grid{display:flex;flex-wrap:wrap;gap:12px}
    .small{font-size:0.9rem;color:#555}
    .stars{cursor:pointer;display:inline-block}
    .seller-panel{border:1px solid #ccc;padding:12px;border-radius:8px;margin-top:12px}
    .modal{position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:999}
    .modal .box{background:#fff;padding:16px;border-radius:8px;width:90%;max-width:480px}
  </style>
</head>
<body>
<header>
  <div class="container">
    <h1>Student Art Hub</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="art.html">Art Showcase</a>
      <a href="books.html">Book Exchange</a>
      <a href="sketches.html">Custom Sketches</a>
      <a href="notes.html">Handwritten Notes</a>
          <a href="donations.html">Donations</a>
    </nav>
  </div>
</header>

<main class="container">
  <section>
<h2>Custom Sketch Artists üé®</h2>
<p class="small">
  Choose an artist and request a custom sketch.
</p>

<div id="artistList" class="grid"></div>

    
<footer style="margin-top:20px">
  <div class="container"><p>¬© 2025 Student Art Hub</p></div>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBxD8SLW9z8ndgAJprcGolqivlNUZVYZxc",
  authDomain: "art-hub-77eb1.firebaseapp.com",
  databaseURL: "https://art-hub-77eb1-default-rtdb.firebaseio.com",
  projectId: "art-hub-77eb1"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const artistList = document.getElementById("artistList");

// üî• MAIN LOGIC: SELLERS = ARTISTS
onValue(ref(db, "users"), snap => {
  const users = snap.val() || {};
  artistList.innerHTML = "";

  Object.entries(users).forEach(([uid, user]) => {
    if (user.role === "seller") {

      const card = document.createElement("div");
      card.className = "card";

      card.innerHTML = `
        <img src="https://via.placeholder.com/300?text=Artist" />
        <h3>${user.name || "Unnamed Artist"}</h3>
        <p class="small rating">‚≠ê Loading...</p>

        <p class="small">Custom Sketch Artist</p>
        <button onclick="openArtist('${uid}')">
          View Artist
        </button>
      `;
const ratingRef = ref(db, "ratings/" + uid);

onValue(ratingRef, snap => {
  let ratingText = "‚≠ê No ratings";

  if (snap.exists()) {
    const arr = Object.values(snap.val());
    const avg = (
      arr.reduce((s, r) => s + r.stars, 0) / arr.length
    ).toFixed(1);

    ratingText = `‚≠ê ${avg} / 5 (${arr.length})`;
  }

  card.querySelector(".rating").textContent = ratingText;
});

      artistList.appendChild(card); 
    }
  });
  if (!artistList.children.length) {
  artistList.innerHTML = "<p class='small'>No artists available right now.</p>";
}

});

window.openArtist = (id) => {
  window.location.href = "artist.html?id=" + id;
};
</script>

</body>
</html>
