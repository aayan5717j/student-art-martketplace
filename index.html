<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Student Art Hub: Buy, sell, and exchange student-made art, books, sketches, and notes at affordable prices." />
  <meta name="keywords" content="student art, marketplace, buy sell art, custom sketches, handwritten notes, book exchange" />
  <title>Student Art Hub</title>

<style>
body{margin:0;font-family:Arial;background:#f2f2f2}
header{background:#1e3a8a;color:#fff;padding:15px}
nav a{color:#fff;margin:0 10px;text-decoration:none;font-weight:bold}
.container{padding:20px}
.hero{background:#fff;padding:30px;border-radius:10px}
input,select,button,textarea{padding:8px;margin:5px;width:100%;max-width:320px}
button{cursor:pointer;background:#1e3a8a;color:#fff;border:none;border-radius:5px}
.grid{display:flex;gap:15px;flex-wrap:wrap}
.card{background:#fff;padding:15px;border-radius:10px;width:220px}
footer{background:#111;color:#fff;text-align:center;padding:15px;margin-top:40px}
</style>
</head>

<body>

<header>
  <h2>Student Art Hub</h2>
  <nav>
          <a href="index.html">Home</a>
      <a href="art.html">Art Showcase</a>
      <a href="books.html">Book Exchange</a>
      <a href="sketches.html">Custom Sketches</a>
      <a href="notes.html">Handwritten Notes</a>
      <a href="donations.html">Donations</a>
  </nav>
</header>

<div class="container">

<!-- HERO -->
<section class="hero">
  <h2>Buy • Sell • Exchange — Student-made</h2>
  <p>Artworks, books, sketches & handwritten notes</p>
  <input id="searchBar" placeholder="Search..." />
  <button id="searchBtn">Search</button>
</section>

<!-- AUTH -->
<section id="authSection">
  <h3>Login / Signup</h3>
  <input id="email" type="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <select id="role">
    <option value="buyer">Buyer</option>
    <option value="seller">Seller</option>
  </select><br>
  <button id="signupBtn">Sign Up</button>
  <button id="loginBtn">Login</button>
  <p id="authMsg"></p>
</section>

<!-- DASHBOARD -->
<section id="dashboard" style="display:none">
  <h3>User Dashboard</h3>
  <p id="userInfo"></p>
  <button id="logoutBtn">Logout</button>

  <div id="sellerPanel" style="display:none">
    <h4>Add Listing</h4>
    <input id="titleInput" placeholder="Title">
    <input id="priceInput" placeholder="Price">
    <input id="categoryInput" placeholder="Category">
    <button id="addBtn">Upload</button>

    <h4>Your Listings</h4>
    <div id="myListings"></div>
  </div>
</section>

<!-- PRODUCTS -->
<h3>Available Listings</h3>
<div id="productContainer" class="grid"></div>

<!-- DONATION -->
<section>
  <h3>Donate</h3>
  <input id="donateName" placeholder="Your Name">
  <select id="donateType">
    <option value="book">Book</option>
    <option value="money">Money</option>
    <option value="other">Other</option>
  </select>
  <textarea id="donateMsg" placeholder="Message"></textarea>
  <button id="donateBtn">Donate via WhatsApp</button>
</section>

</div>

<footer>
<p>© 2025 Student Art Hub — Built by Aryan</p>
</footer>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import {
  getAuth,
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  signOut,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
import {
  getDatabase,
  ref,
  set,
  push,
  onValue,
  remove,
  update
} from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBxD8SLW9z8ndgAJprcGolqivlNUZVYZxc",
  authDomain: "art-hub-77eb1.firebaseapp.com",
  databaseURL: "https://art-hub-77eb1-default-rtdb.firebaseio.com",
  projectId: "art-hub-77eb1",
  storageBucket: "art-hub-77eb1.appspot.com",
  messagingSenderId: "1097170910592",
  appId: "1:1097170910592:web:8590c10f6d0662d6881565"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

signupBtn.onclick = async ()=>{
  await createUserWithEmailAndPassword(auth,email.value,password.value);
  authMsg.textContent="Signup successful";
};

loginBtn.onclick = async ()=>{
  await signInWithEmailAndPassword(auth,email.value,password.value);
};

logoutBtn.onclick = ()=>signOut(auth);

onAuthStateChanged(auth,user=>{
  if(user){
    authSection.style.display="none";
    dashboard.style.display="block";
    userInfo.textContent="Logged in as "+user.email;

    if(role.value==="seller") sellerPanel.style.display="block";
    loadAllListings();
    loadMyListings(user.uid);
  }else{
    authSection.style.display="block";
    dashboard.style.display="none";
  }
});

addBtn.onclick = async ()=>{
  const listingRef = push(ref(db,"listings"));
  await set(listingRef,{
    title:titleInput.value,
    price:priceInput.value,
    category:categoryInput.value,
    seller:auth.currentUser.uid
  });
};

function loadAllListings(filter=""){
  onValue(ref(db,"listings"),snap=>{
    productContainer.innerHTML="";
    snap.forEach(c=>{
      const d=c.val();
      if(filter && !d.title.toLowerCase().includes(filter.toLowerCase())) return;
      const div=document.createElement("div");
      div.className="card";
      div.innerHTML=`<b>${d.title}</b><br>₹${d.price}<br>${d.category}`;
      productContainer.appendChild(div);
    });
  });
}

function loadMyListings(uid){
  onValue(ref(db,"listings"),snap=>{
    myListings.innerHTML="";
    snap.forEach(c=>{
      const d=c.val();
      if(d.seller===uid){
        const div=document.createElement("div");
        div.innerHTML=`${d.title} - ₹${d.price}
        <button onclick="deleteItem('${c.key}')">Delete</button>`;
        myListings.appendChild(div);
      }
    });
  });
}

window.deleteItem=(id)=>{
  remove(ref(db,"listings/"+id));
};

searchBtn.onclick=()=>{
  loadAllListings(searchBar.value);
};

donateBtn.onclick=()=>{
  const msg=`Donation\nName:${donateName.value}\nType:${donateType.value}\nMessage:${donateMsg.value}`;
  window.open(`https://wa.me/918882529632?text=${encodeURIComponent(msg)}`,"_blank");
};

loadAllListings();
</script>

</body>
</html>
